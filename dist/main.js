(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(r,e){if("object"==typeof exports){var n=e();"object"==typeof module&&module&&module.exports&&(exports=module.exports=n),exports.randomColor=n}else"function"==typeof define&&define.amd?define([],e):r.randomColor=e()}(this,function(){function r(r){var e=i(o(r.hue));return e<0&&(e=360+e),e}function e(r,e){if("monochrome"===e.hue)return 0;if("random"===e.luminosity)return i([0,100]);var n=u(r),t=n[0],a=n[1];switch(e.luminosity){case"bright":t=55;break;case"dark":t=a-10;break;case"light":a=55}return i([t,a])}function n(r,e,n){var t=a(r,e),o=100;switch(n.luminosity){case"dark":o=t+20;break;case"light":t=(o+t)/2;break;case"random":t=0,o=100}return i([t,o])}function t(r,e){switch(e.format){case"hsvArray":return r;case"hslArray":return d(r);case"hsl":var n=d(r);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var t=d(r),a=e.alpha||Math.random();return"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+a+")";case"rgbArray":return f(r);case"rgb":return"rgb("+f(r).join(", ")+")";case"rgba":var o=f(r),a=e.alpha||Math.random();return"rgba("+o.join(", ")+", "+a+")";default:return l(r)}}function a(r,e){for(var n=s(r).lowerBounds,t=0;t<n.length-1;t++){var a=n[t][0],o=n[t][1],u=n[t+1][0],i=n[t+1][1];if(e>=a&&e<=u){var l=(i-o)/(u-a);return l*e+(o-l*a)}}return 0}function o(r){if("number"==typeof parseInt(r)){var e=parseInt(r);if(e<360&&e>0)return[e,e]}if("string"==typeof r)if(m[r]){var n=m[r];if(n.hueRange)return n.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var t=h(r)[0];return[t,t]}return[0,360]}function u(r){return s(r).saturationRange}function s(r){r>=334&&r<=360&&(r-=360);for(var e in m){var n=m[e];if(n.hueRange&&r>=n.hueRange[0]&&r<=n.hueRange[1])return m[e]}return"Color not found"}function i(r){if(null===v)return Math.floor(r[0]+Math.random()*(r[1]+1-r[0]));var e=r[1]||1,n=r[0]||0,t=(v=(9301*v+49297)%233280)/233280;return Math.floor(n+t*(e-n))}function l(r){function e(r){var e=r.toString(16);return 1==e.length?"0"+e:e}var n=f(r);return"#"+e(n[0])+e(n[1])+e(n[2])}function c(r,e,n){var t=n[0][0],a=n[n.length-1][0],o=n[n.length-1][1],u=n[0][1];m[r]={hueRange:e,lowerBounds:n,saturationRange:[t,a],brightnessRange:[o,u]}}function f(r){var e=r[0];0===e&&(e=1),360===e&&(e=359),e/=360;var n=r[1]/100,t=r[2]/100,a=Math.floor(6*e),o=6*e-a,u=t*(1-n),s=t*(1-o*n),i=t*(1-(1-o)*n),l=256,c=256,f=256;switch(a){case 0:l=t,c=i,f=u;break;case 1:l=s,c=t,f=u;break;case 2:l=u,c=t,f=i;break;case 3:l=u,c=s,f=t;break;case 4:l=i,c=u,f=t;break;case 5:l=t,c=u,f=s}return[Math.floor(255*l),Math.floor(255*c),Math.floor(255*f)]}function h(r){r=3===(r=r.replace(/^#/,"")).length?r.replace(/(.)/g,"$1$1"):r;var e=parseInt(r.substr(0,2),16)/255,n=parseInt(r.substr(2,2),16)/255,t=parseInt(r.substr(4,2),16)/255,a=Math.max(e,n,t),o=a-Math.min(e,n,t),u=a?o/a:0;switch(a){case e:return[(n-t)/o%6*60||0,u,a];case n:return[60*((t-e)/o+2)||0,u,a];case t:return[60*((e-n)/o+4)||0,u,a]}}function d(r){var e=r[0],n=r[1]/100,t=r[2]/100,a=(2-n)*t;return[e,Math.round(n*t/(a<1?a:2-a)*1e4)/100,a/2*100]}function g(r){for(var e=0,n=0;n!==r.length&&!(e>=Number.MAX_SAFE_INTEGER);n++)e+=r.charCodeAt(n);return e}var v=null,m={};c("monochrome",null,[[0,0],[100,0]]),c("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),c("orange",[19,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),c("yellow",[47,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),c("green",[63,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),c("blue",[179,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),c("purple",[258,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),c("pink",[283,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]);var p=function(a){if(void 0!==(a=a||{}).seed&&null!==a.seed&&a.seed===parseInt(a.seed,10))v=a.seed;else if("string"==typeof a.seed)v=g(a.seed);else{if(void 0!==a.seed&&null!==a.seed)throw new TypeError("The seed value must be an integer or string");v=null}var o,u,s;if(null!==a.count&&void 0!==a.count){var i=a.count,l=[];for(a.count=null;i>l.length;)v&&a.seed&&(a.seed+=1),l.push(p(a));return a.count=i,l}return o=r(a),u=e(o,a),s=n(o,u,a),t([o,u,s],a)};return p});

},{}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_request=require("../helpers/request"),_request2=_interopRequireDefault(_request),$=window.jQuery,_class=function(){function e(t){_classCallCheck(this,e),this.$el=t,this.lastCall=null,this.load()}return _createClass(e,[{key:"setOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=document.createDocumentFragment(),n=!1;t.constructor!==Array&&(t=[t]),e.constructor===Array&&(n=!0),Object.keys(e).forEach(function(a){var s=e[a],l=document.createElement("option");l.innerHTML=s,n||(l.value=a),-1!==t.indexOf(a)&&(l.selected=!0),r.appendChild(l)}),this.$el.innerHTML="",this.$el.appendChild(r)}},{key:"getValue",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,a=this.$el.children[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var s=n.value;if(s.selected)return s.value}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}return!1}},{key:"getEndpoint",value:function(){return this.$el.dataset.endpoint}},{key:"load",value:function(){var e=this,t=$.extend({action:this.getEndpoint()},this.getRequestParams());return this.lastCall&&JSON.stringify(this.lastCall)===JSON.stringify(t)?this.req:(this.req=(0,_request2.default)(t).done(function(t){e.setOptions(t,e.getDefaultValue())}).fail(function(e){e.message?alert(e.message):alert("There was some issue with telemetry. Please send info support@shortlistmedia.freshdesk.com")}),this.req)}},{key:"getRequestParams",value:function(){return JSON.parse(this.$el.dataset.params)}},{key:"getDefaultValue",value:function(){return JSON.parse(this.$el.dataset.value)}}]),e}();exports.default=_class;

},{"../helpers/request":3}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e){var a=JSON.stringify(e);if(cache[a])return cache[a];var r=$.ajax({dataType:"json",url:window.ajaxurl,data:e,method:"POST"});return cache[a]=r,r};var cache={},$=window.jQuery;

},{}],4:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _Select=require("./fields/Select"),_Select2=_interopRequireDefault(_Select),_calendar=require("./ui/calendar"),_calendar2=_interopRequireDefault(_calendar),_download=require("./ui/download"),_download2=_interopRequireDefault(_download),$=window.jQuery;window.acf&&window.acf.add_action("ready append",function(e){window.acf.get_fields({type:"telemetry_async_select"},e).each(function(){this.classList.contains("js-telemetry-initiated")||(this.classList.add("js-telemetry-initiated"),new _Select2.default(this.querySelector("select")))});var t=window.acf.get_fields({key:"telemetry_acquisition_telemetry_id"},e);t.length>0&&$("body").addClass("telemetry-already-added"),t.each(function(){var e=$(this),t=e.parents("[data-layout='telemetry_acquisition']"),a=e.find("input[type='text']").val();a&&!t.hasClass("telemetry_download_initiated")&&(t.addClass("telemetry_download_initiated"),(0,_download2.default)(e.parents("[data-layout='telemetry_acquisition']"),a))})}),$(function(){$("body").hasClass("toplevel_page_telemetry_calendar")&&(0,_calendar2.default)()});

},{"./fields/Select":2,"./ui/calendar":5,"./ui/download":7}],5:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function e(e,t){var r=$("#calendar").fullCalendar("getDate").format("YYYY-MM-DD"),o={action:"telemetry_acquisitions",start:moment(r).subtract(1,"months").date(1).format("YYYY-MM-DD"),end:moment(r).add(2,"months").date(0).format("YYYY-MM-DD")};(0,_request2.default)(o).then(function(e){e.acquisitions.map(function(e){e.backgroundColor=(0,_randomcolor2.default)({luminosity:"light",seed:e.title})}),$("#calendar").fullCalendar("renderEvents",e.acquisitions)})}function t(e){var t={action:"telemetry_promotion_metadata",promo_id:e};(0,_request2.default)(t).then(function(e){window.sweetAlert({title:'<span style="color:#000">'+e.title+"</span>",text:'<ul style="color:#000;text-align:left;"><li><b>URL:</b> <a href="'+e.url+'">'+e.url+"</a></li><li><b>Entries:</b> "+e.totalEntries+"</li>"+(e.corrects?"<li><b>Correct entries:</b> "+e.corrects+"</li>":"")+"<li><b>New subscribers:</b> "+e.newSubscribers+"</li></ul>",html:!0,type:"info"})}).fail(function(){window.sweetAlert({title:'<span style="color:#000">There was a problem getting the data for this promotion</span>',text:'<p style="color:#000">Something went a bit wrong, but we\'re not sure what. Drop us an email at <a href="mailto:jon.sherrard@shortlist.com">jon.sherrard@shortlist.com</a> and we\'ll take a look into it for you.</p>',html:!0,type:"error"})})}(0,_dep.fullCalendarLoad)(),(0,_dep.sweetAlertLoad)(),$("#calendar").fullCalendar({eventClick:function(e){t(e.id)},viewRender:function(t,r){e()}})};var _randomcolor=require("randomcolor"),_randomcolor2=_interopRequireDefault(_randomcolor),_dep=require("./dep"),_request=require("../helpers/request"),_request2=_interopRequireDefault(_request),$=window.jQuery;

},{"../helpers/request":3,"./dep":6,"randomcolor":1}],6:[function(require,module,exports){
"use strict";function sweetAlertLoad(){if(sweet)return!0;sweet=!0,$.getScript("https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.2/sweetalert.min.js");var e=document.createElement("link");e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css";var t=document.getElementsByTagName("link")[0];t.parentNode.insertBefore(e,t)}function fullCalendarLoad(){if(calendar)return!0;calendar=!0;var e=document.createElement("link");e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.1.0/fullcalendar.min.css";var t=document.getElementsByTagName("link")[0];t.parentNode.insertBefore(e,t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.sweetAlertLoad=sweetAlertLoad,exports.fullCalendarLoad=fullCalendarLoad;var $=window.jQuery,sweet=!1,calendar=!1;

},{}],7:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e,t){function a(e,a){var o=$('<a href="#" class="acf-button button button-primary" style="text-align: left;">'+e+"</a><br><br>");o.click(function(){(0,_request2.default)(Object.assign({action:"telemetry_download",promo_id:parseInt(t)},a)).then(l).fail(i)}),$(n).append(o)}function l(e){var t=e.data.password;window.sweetAlert({title:'<span style="color:#000">Your download request was successful!</span>',text:'<p style="color:#000">You\'ll get an email to say it\'s ready. Please make a note of this password as you\'ll need it to open the file:</p><p style="margin-top:20px;color:#000">'+t+"</p>",html:!0,type:"success"})}function i(){window.sweetAlert({title:'<span style="color:#000">There was a problem with your download request!</span>',text:'<span style="color:#000">Something went a bit wrong, but we\'re not sure what. Drop us an email at <a href="mailto:jon.sherrard@shortlist.com">jon.sherrard@shortlist.com</a> and we\'ll take a look into it for you.</span>',html:!0,type:"warning"})}(0,_dep.sweetAlertLoad)();var o=e.find(".acf-tab-group");o.append('<li><a class="acf-tab-button" href="#" data-key="telemetry_download">Download</a></li>'),o.parent().parent().css("min-height","+=39px").append(['<div class="acf-field acf-field-tab acf-field-telemetry-download-tab hidden-by-tab" data-name="telemetry_download" data-type="tab" data-key="telemetry_download">','<div class="acf-label">','<label for="acf-post_widgets-0-telemetry_acquisition_advanced_details_tab">Advanced Details</label>',"</div>",'<div class="acf-input">','<div class="acf-tab" data-placement="left" data-endpoint="0">Advanced Details</div>',"</div>","</div>",'<div class="acf-field acf-field-telemetry-download hidden-by-tab" data-key="telemetry_download">','<div class="acf-field acf-field-strict-wysiwyg acf-field-telemetry-acquisition-thank-you-screen-title" data-name="thank_you_screen_title" data-type="strict_wysiwyg" data-key="telemetry_acquisition_thank_you_screen_title">','<div class="acf-label">',"<label>Download</label>","</div>",'<div class="acf-input" id="download_buttons_'+t+'">',"</div>","</div>","</div>"].join("\n"));var n="#download_buttons_"+t;a("All",[]),$('input[name*="[telemetry_acquisition_data_to_capture][]"][value="competition"]:checked').length&&a("Correct Only",{type:"correct"}),$('input[name*="[telemetry_acquisition_optin_optin_name]"]').each(function(){var e=$(this).val();e&&a(e+" Opt-ins",{optin:e})})};var _dep=require("./dep"),_request=require("../helpers/request"),_request2=_interopRequireDefault(_request),$=window.jQuery;

},{"../helpers/request":3,"./dep":6}]},{},[4]);
